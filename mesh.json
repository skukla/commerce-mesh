{
  "meshConfig": {
    "sources": [
      {
        "name": "CommerceGraphQL",
        "handler": {
          "graphql": {
            "endpoint": "{env.ADOBE_COMMERCE_GRAPHQL_ENDPOINT}",
            "operationHeaders": {
              "Content-Type": "application/json",
              "Store": "{context.headers['store']}"
            }
          }
        },
        "transforms": [
          {
            "prefix": {
              "value": "Commerce_",
              "includeRootOperations": true
            }
          }
        ]
      },
      {
        "name": "CatalogServiceSandbox",
        "handler": {
          "graphql": {
            "endpoint": "{env.ADOBE_SANDBOX_CATALOG_SERVICE_ENDPOINT}",
            "operationHeaders": {
              "Content-Type": "application/json",
              "Magento-Environment-Id": "{context.headers['magento-environment-id']}",
              "Magento-Website-Code": "{context.headers['magento-website-code']}",
              "Magento-Store-View-Code": "{context.headers['magento-store-view-code']}",
              "Magento-Store-Code": "{context.headers['magento-store-code']}",
              "Magento-Customer-Group": "{context.headers['magento-customer-group']}",
              "X-Api-Key": "{context.headers['x-api-key']}",
              "Authorization": "{context.headers['Authorization']}"
            },
            "schemaHeaders": {
              "x-api-key": "{env.ADOBE_CATALOG_API_KEY}",
              "Magento-Environment-Id": "{env.ADOBE_COMMERCE_ENVIRONMENT_ID}",
              "Magento-Website-Code": "{env.ADOBE_COMMERCE_WEBSITE_CODE}",
              "Magento-Store-View-Code": "{env.ADOBE_COMMERCE_STORE_VIEW_CODE}",
              "Magento-Store-Code": "{env.ADOBE_COMMERCE_STORE_CODE}"
            }
          }
        },
        "transforms": [
          {
            "prefix": {
              "value": "Catalog_",
              "includeRootOperations": true
            }
          }
        ],
        "responseConfig": {
          "headers": [
            "X-Magento-Cache-Id"
          ]
        }
      },
      {
        "name": "LiveSearchSandbox",
        "handler": {
          "graphql": {
            "endpoint": "{env.ADOBE_SANDBOX_CATALOG_SERVICE_ENDPOINT}",
            "operationHeaders": {
              "Content-Type": "application/json",
              "Magento-Environment-Id": "{context.headers['magento-environment-id']}",
              "Magento-Website-Code": "{context.headers['magento-website-code']}",
              "Magento-Store-View-Code": "{context.headers['magento-store-view-code']}",
              "Magento-Store-Code": "{context.headers['magento-store-code']}",
              "Magento-Customer-Group": "{context.headers['magento-customer-group']}",
              "X-Api-Key": "search_gql"
            },
            "schemaHeaders": {
              "x-api-key": "{env.ADOBE_CATALOG_API_KEY}",
              "Magento-Environment-Id": "{env.ADOBE_COMMERCE_ENVIRONMENT_ID}",
              "Magento-Website-Code": "{env.ADOBE_COMMERCE_WEBSITE_CODE}",
              "Magento-Store-View-Code": "{env.ADOBE_COMMERCE_STORE_VIEW_CODE}",
              "Magento-Store-Code": "{env.ADOBE_COMMERCE_STORE_CODE}",
              "X-Api-Key": "search_gql"
            }
          }
        },
        "transforms": [
          {
            "prefix": {
              "value": "Search_",
              "includeRootOperations": true
            }
          }
        ]
      }
    ],
    "transforms": [
      {
        "filterSchema": {
          "mode": "bare",
          "filters": [
            "Type.!Mutation",
            "Query.{Citisignal_*, Catalog_productSearch, Search_productSearch, Commerce_categoryList}"
          ]
        }
      }
    ],
    "responseConfig": {
      "CORS": {
        "credentials": true,
        "exposedHeaders": [
          "Content-Range",
          "X-Content-Range",
          "X-Magento-Cache-Id"
        ],
        "maxAge": 60480,
        "methods": [
          "GET",
          "POST"
        ],
        "origin": "*"
      }
    },
    "additionalTypeDefs": "type Citisignal_CategoryItem {\n  id: String!\n  name: String!\n  urlPath: String!\n  urlKey: String!\n  level: Int!\n  position: Int!\n  includeInMenu: Boolean!\n  isActive: Boolean!\n  children: [Citisignal_CategoryItem!]!\n  productCount: Int!\n  parentId: String\n  href: String!\n  label: String!\n}\n\ntype Citisignal_NavItem {\n  href: String!\n  label: String!\n  category: String\n}\n\ntype Citisignal_FooterNavItem {\n  href: String!\n  label: String!\n}\n\ntype Citisignal_CategoryNavigationResponse {\n  items: [Citisignal_CategoryItem!]!\n  headerNav: [Citisignal_NavItem!]!\n  footerNav: [Citisignal_FooterNavItem!]!\n}\n\ntype Citisignal_BreadcrumbItem {\n  categoryId: String\n  name: String!\n  urlPath: String!\n  level: Int!\n}\n\ntype Citisignal_BreadcrumbResponse {\n  items: [Citisignal_BreadcrumbItem!]!\n}\n\nextend type Query {\n  Citisignal_categoryNavigation(\n    rootCategoryId: String\n    includeInactive: Boolean\n  ): Citisignal_CategoryNavigationResponse\n  \n  Citisignal_categoryBreadcrumbs(\n    categoryUrlKey: String!\n  ): Citisignal_BreadcrumbResponse\n}\n\ntype Citisignal_CategoryInfo {\n  id: String\n  name: String!\n  urlKey: String!\n  description: String\n  metaTitle: String\n  metaDescription: String\n}\n\ntype Citisignal_CategoryPageData {\n  navigation: Citisignal_CategoryNavigationResponse!\n  products: Citisignal_ProductCardResult!\n  facets: Citisignal_ProductFacetsResult!\n  breadcrumbs: Citisignal_BreadcrumbResponse!\n  categoryInfo: Citisignal_CategoryInfo!\n}\n\nextend type Query {\n  Citisignal_categoryPageData(\n    categoryUrlKey: String  # Optional URL key like \"phones\" - omit for all products\n    phrase: String  # Optional search term within category\n    filter: Citisignal_PageFilter  # Additional filters (manufacturer, price, etc.)\n    sort: Citisignal_SortInput\n    pageSize: Int\n    currentPage: Int\n  ): Citisignal_CategoryPageData\n}\n\nextend type Catalog_ComplexProductView {\n  manufacturer: String\n  memory_options: [String]\n  available_colors: [Citisignal_ColorOption]\n  is_on_sale: Boolean\n  display_price: Float\n  display_currency: String\n  discount_percentage: Float\n  in_stock: Boolean\n  secure_image: Catalog_ProductViewImage\n  secure_images: [Catalog_ProductViewImage]\n}\n\nextend type Catalog_SimpleProductView {\n  manufacturer: String\n  is_on_sale: Boolean\n  display_price: Float\n  display_currency: String\n  discount_percentage: Float\n  in_stock: Boolean\n  secure_image: Catalog_ProductViewImage\n  secure_images: [Catalog_ProductViewImage]\n}\n\ntype Citisignal_ColorOption {\n  name: String\n  hex: String\n}\n\ntype Citisignal_ProductImage {\n  url: String\n  altText: String\n}\n\ntype Citisignal_ProductCard {\n  id: String!\n  sku: String!\n  urlKey: String!\n  name: String!\n  manufacturer: String\n  price: String!\n  originalPrice: String\n  discountPercent: Int\n  inStock: Boolean!\n  image: Citisignal_ProductImage\n  memory: [String]\n  colors: [Citisignal_ColorOption]\n}\n\ntype Citisignal_PageInfo {\n  current_page: Int!\n  page_size: Int!\n  total_pages: Int!\n}\n\ntype Citisignal_ProductCardResult {\n  items: [Citisignal_ProductCard]\n  totalCount: Int\n  hasMoreItems: Boolean!\n  currentPage: Int\n  page_info: Citisignal_PageInfo\n  _debug: String # Debug information when requested\n}\n\ninput Citisignal_ProductFilter {\n  categoryUrlKey: String # Category URL key like \"phones\" or \"accessories\"\n  facets: JSON\n  manufacturer: String\n  memory: [String]\n  color: [String]\n  price: [String] # Price ranges like [\"300.0-400.0\"]\n  onSaleOnly: Boolean\n}\n\ninput Citisignal_PageFilter {\n  facets: JSON\n  manufacturer: String\n  memory: [String]\n  color: [String]\n  price: [String] # Price ranges like [\"300.0-400.0\"]\n  onSaleOnly: Boolean\n}\n\nenum Citisignal_SortDirection {\n  ASC\n  DESC\n}\n\nenum Citisignal_ProductSortAttribute {\n  RELEVANCE # Default for search results\n  PRICE # Sort by price\n  NAME # Sort by product name\n}\n\ninput Citisignal_SortInput {\n  attribute: Citisignal_ProductSortAttribute!\n  direction: Citisignal_SortDirection!\n}\n\nextend type Query {\n  Citisignal_productCards(\n    phrase: String\n    filter: Citisignal_ProductFilter\n    limit: Int = 20\n    page: Int = 1\n    sort: Citisignal_SortInput\n  ): Citisignal_ProductCardResult\n}\n\ntype Citisignal_ProductAttribute {\n  key: String!\n  label: String!\n  value: String!\n  type: String\n}\n\ntype Citisignal_ProductDetail {\n  id: String!\n  sku: String!\n  name: String!\n  urlKey: String!\n  price: String!\n  originalPrice: String\n  discountPercent: Int\n  inStock: Boolean!\n  stockLevel: Int\n  manufacturer: String\n\n  description: String\n  shortDescription: String\n\n  images: [Citisignal_ProductImage!]!\n\n  attributes: [Citisignal_ProductAttribute!]!\n\n  breadcrumbs: Citisignal_ProductBreadcrumbs\n\n  configurable_options: [Citisignal_ConfigurableOption!]!\n\n  variants: [Citisignal_ProductVariant!]!\n}\n\ntype Citisignal_ConfigurableOption {\n  label: String!\n  attribute_code: String!\n  values: [Citisignal_ConfigurableOptionValue!]!\n}\n\ntype Citisignal_ConfigurableOptionValue {\n  label: String!\n  value: String!\n  swatch_data: Citisignal_SwatchData\n}\n\ntype Citisignal_SwatchData {\n  type: String!\n  value: String!\n}\n\ntype Citisignal_ProductVariant {\n  id: String!\n  sku: String!\n  attributes: JSON\n  price: String!\n  originalPrice: String\n  inStock: Boolean!\n  image: Citisignal_ProductImage\n}\n\ntype Citisignal_ProductBreadcrumbs {\n  items: [Citisignal_BreadcrumbItem!]!\n}\n\ntype Citisignal_BreadcrumbItem {\n  name: String!\n  urlPath: String!\n}\n\nextend type Query {\n  Citisignal_productDetail(urlKey: String!): Citisignal_ProductDetail\n}\n\ntype Citisignal_FacetOption {\n  id: String!\n  name: String!\n  count: Int!\n}\n\ntype Citisignal_Facet {\n  title: String!         # Display name from Adobe Commerce\n  key: String!           # SEO-friendly URL key (e.g., \"manufacturer\")\n  attributeCode: String! # Original Adobe attribute code (e.g., \"cs_manufacturer\")\n  type: String!\n  options: [Citisignal_FacetOption]!\n}\n\ntype Citisignal_ProductFacetsResult {\n  facets: [Citisignal_Facet]!\n  totalCount: Int\n}\n\nextend type Query {\n  Citisignal_productFacets(\n    phrase: String\n    filter: Citisignal_ProductFilter\n  ): Citisignal_ProductFacetsResult\n}\n\ntype Citisignal_ProductSearchFilterResult {\n  products: Citisignal_ProductCardResult!\n  \n  facets: Citisignal_ProductFacetsResult!\n  \n  totalCount: Int\n}\n\nextend type Query {\n  Citisignal_productSearchFilter(\n    phrase: String\n    \n    filter: Citisignal_ProductFilter\n    \n    sort: Citisignal_SortInput\n    \n    limit: Int = 20\n    page: Int = 1\n  ): Citisignal_ProductSearchFilterResult\n}\n\n\"\"\"\nThe JSON scalar type represents JSON values as specified by ECMA-404.\nUsed for dynamic filter objects that can contain any key-value pairs.\nThis enables business users to configure custom facets in Adobe Commerce\nwithout requiring code changes.\n\"\"\"\nscalar JSON\n\ntype Citisignal_ProductSuggestion {\n  id: String!\n  name: String!\n  sku: String!\n  urlKey: String!\n  price: String\n  image: String\n}\n\ntype Citisignal_SearchSuggestionsResult {\n  suggestions: [Citisignal_ProductSuggestion]!\n  totalCount: Int\n}\n\nextend type Query {\n  Citisignal_searchSuggestions(\n    phrase: String!\n  ): Citisignal_SearchSuggestionsResult\n}",
    "additionalResolvers": [
      "./build/resolvers/category-breadcrumbs.js",
      "./build/resolvers/category-navigation.js",
      "./build/resolvers/category-page.js",
      "./build/resolvers/field-extensions.js",
      "./build/resolvers/product-cards.js",
      "./build/resolvers/product-detail.js",
      "./build/resolvers/product-facets.js",
      "./build/resolvers/product-search-filter.js",
      "./build/resolvers/search-suggestions.js"
    ]
  }
}