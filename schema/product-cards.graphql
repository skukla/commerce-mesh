# Product Cards Query Schema
#
# Types and query for product listing/category pages
# Supports both Catalog Service and Live Search
# Facets are handled by separate Citisignal_productFacets query

# Shared types used by product cards
type Citisignal_ColorOption {
  name: String
  hex: String
}

type Citisignal_ProductImage {
  url: String
  altText: String
}

# Minimal configurable option data for cards (subset of full product detail)
type Citisignal_ConfigurableOptionValue {
  label: String!
  value: String!
  swatch_data: Citisignal_SwatchData
}

type Citisignal_SwatchData {
  type: String  # "1" for color, "2" for image, "0" for text
  value: String # Hex color, image URL, or text value
}

type Citisignal_ConfigurableOption {
  label: String!
  attribute_code: String!
  values: [Citisignal_ConfigurableOptionValue!]!
}

# Product card type for listing pages
type Citisignal_ProductCard {
  id: String!
  sku: String!
  urlKey: String!
  name: String!
  manufacturer: String
  price: String!
  originalPrice: String
  discountPercent: Int
  inStock: Boolean!
  image: Citisignal_ProductImage     
  memory: [String]   
  colors: [Citisignal_ColorOption]
  # Minimal configurable options for variant selection on cards
  configurable_options: [Citisignal_ConfigurableOption!]
  # Indicates if this product requires variant selection
  isConfigurable: Boolean!
}

# Page info for pagination
type Citisignal_PageInfo {
  current_page: Int!
  page_size: Int!
  total_pages: Int!
}

# Product search result with pagination
type Citisignal_ProductCardResult {
  items: [Citisignal_ProductCard]
  totalCount: Int
  hasMoreItems: Boolean!
  currentPage: Int
  page_info: Citisignal_PageInfo
  _debug: String  # Debug information when requested
}

# Filter input for product searches (includes category for standalone queries)
input Citisignal_ProductFilter {
  categoryUrlKey: String  # Category URL key like "phones" or "accessories"
  # Dynamic facets as JSON object - accepts any attribute codes from Adobe
  # Example: {"cs_manufacturer": ["Apple"], "custom_field": ["value"]}
  facets: JSON
  # Legacy support - will be deprecated
  manufacturer: String
  memory: [String]
  color: [String]
  price: [String]        # Price ranges like ["300.0-400.0"]
  onSaleOnly: Boolean
}

# Filter input for page-level queries (category comes from resolver parameter)
input Citisignal_PageFilter {
  # Dynamic facets as JSON object - accepts any attribute codes from Adobe
  # Example: {"cs_manufacturer": ["Apple"], "custom_field": ["value"]}
  facets: JSON
  # Legacy support - will be deprecated
  manufacturer: String
  memory: [String]
  color: [String]
  price: [String]        # Price ranges like ["300.0-400.0"]
  onSaleOnly: Boolean
}

# Sort direction enum
enum Citisignal_SortDirection {
  ASC
  DESC
}

# Sort attribute enum for product listings
enum Citisignal_ProductSortAttribute {
  RELEVANCE     # Default for search results
  PRICE         # Sort by price
  NAME          # Sort by product name
}

# Sort options
input Citisignal_SortInput {
  attribute: Citisignal_ProductSortAttribute!
  direction: Citisignal_SortDirection!
}

# Product cards query
extend type Query {
  Citisignal_productCards(
    phrase: String
    filter: Citisignal_ProductFilter
    limit: Int = 20
    page: Int = 1
    sort: Citisignal_SortInput
  ): Citisignal_ProductCardResult
}